(function(){"use strict";var e={410:function(e,l,t){var a=t(5130),n=(t(4114),t(8111),t(2489),t(7588),t(6768)),o=t(4232),u=t(144),r=t(6409),i=t(6400),s=t(9675),c=t(7844);const v={apiKey:"AIzaSyCiTt8sT2AB617XN3TTKMeWfZxXcsIO8g8",authDomain:"calendar-523e8.firebaseapp.com",projectId:"calendar-523e8",storageBucket:"calendar-523e8.firebasestorage.app",messagingSenderId:"511342720597",appId:"1:511342720597:web:58d59e5aaaa56087f606dc",measurementId:"G-ZEFQCTC07V"},d=(0,i.Wp)(v),p=(0,r.xI)(d),k=((0,s.aU)(d),(0,c.c7)(d),{class:"auth-container"}),m={type:"submit",class:"btn"},b={key:0,class:"error-msg"};function f(e,l,t,u,r,i){return(0,n.uX)(),(0,n.CE)("div",k,[(0,n.Lk)("h2",null,(0,o.v_)("login"===u.mode?"登入":"註冊"),1),(0,n.Lk)("form",{onSubmit:l[2]||(l[2]=(0,a.D$)(((...e)=>u.submit&&u.submit(...e)),["prevent"])),class:"auth-form"},[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>u.email=e),type:"email",placeholder:"Email",required:""},null,512),[[a.Jo,u.email]]),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":l[1]||(l[1]=e=>u.password=e),type:"password",placeholder:"密碼",required:""},null,512),[[a.Jo,u.password]]),(0,n.Lk)("button",m,(0,o.v_)("login"===u.mode?"登入":"註冊"),1)],32),(0,n.Lk)("p",{class:"toggle-mode",onClick:l[3]||(l[3]=(...e)=>u.toggleMode&&u.toggleMode(...e))},(0,o.v_)("login"===u.mode?"沒有帳號？去註冊":"已有帳號？去登入"),1),u.error?((0,n.uX)(),(0,n.CE)("p",b,"Firebase: "+(0,o.v_)(u.error),1)):(0,n.Q3)("",!0)])}var g={name:"AuthForm",setup(){const e=(0,u.KR)("login"),l=(0,u.KR)(""),t=(0,u.KR)(""),a=(0,u.KR)("");function n(){a.value="",e.value="login"===e.value?"register":"login"}async function o(){a.value="";try{"login"===e.value?await(0,r.x9)(p,l.value,t.value):await(0,r.eJ)(p,l.value,t.value)}catch(n){a.value=n.code||n.message}}return{mode:e,email:l,password:t,error:a,toggleMode:n,submit:o}}},h=t(1241);const L=(0,h.A)(g,[["render",f],["__scopeId","data-v-22b19095"]]);var y=L,C=t(6730),_=t(7144),E=t(8439),w=t(794);const K={class:"date-picker"},x=["value"],R=["value"],I={key:0,class:"modal-backdrop"},S={class:"modal-content"},X={class:"block mb-2"},O={key:0,class:"preview mb-4"},V=["src"],F={class:"preview mb-4"},A=["src"],U={key:0,class:"mb-2 text-lg font-semibold"},P={key:1,class:"description-text"},J={key:2,class:"description-text empty"},j={class:"btn-group"},D={class:"block mb-2"},$={class:"preview mb-4"},M=["src"];var T={__name:"CalendarView",props:{album:{type:String,required:!0}},setup(e){const l=e,t=["1 月","2 月","3 月","4 月","5 月","6 月","7 月","8 月","9 月","10 月","11 月","12 月"],r=new Date,i=(0,u.KR)(r.getFullYear()),s=(0,u.KR)(r.getMonth()),c=Array.from({length:11},((e,l)=>r.getFullYear()-5+l)),v=(0,u.KR)(null),d=(0,u.KR)(!1),p=(0,u.KR)("upload"),k=(0,u.KR)(""),m=(0,u.KR)(""),b=(0,u.KR)(null),f=(0,u.KR)(null),g=(0,u.KR)(""),h=(0,u.KR)(null);let L=null;function y(){return`photoDiary__${l.album}__`}function T(){L.gotoDate(new Date(i.value,s.value,1))}function W(){for(let e=0;e<localStorage.length;e++){const l=localStorage.key(e);if(!l.startsWith(y()))continue;const t=JSON.parse(localStorage.getItem(l));L.addEvent({id:t.id,title:t.title||"",date:t.date,extendedProps:{url:t.url,description:t.description||""}})}}function N(e){const l=e.target.files[0];l&&(b.value=l,f.value=URL.createObjectURL(l))}function Q(){if(!b.value)return alert("請先選擇圖片！");const e=new FileReader;e.onload=()=>{const l=(0,w.A)(),t={id:l,date:k.value,title:m.value.trim(),url:e.result,description:""};localStorage.setItem(y()+l,JSON.stringify(t)),L.addEvent({id:t.id,title:t.title,date:t.date,extendedProps:{url:t.url,description:t.description}}),G()},e.readAsDataURL(b.value)}function q(){if(!confirm("確定要刪除這張照片嗎？"))return;const e=h.value.id;localStorage.removeItem(y()+e),h.value.remove(),G()}function B(){const e=h.value.id,l=y()+e,t=JSON.parse(localStorage.getItem(l));t.title=m.value.trim(),t.description=g.value,localStorage.setItem(l,JSON.stringify(t)),h.value.setProp("title",t.title),h.value.setExtendedProp("description",t.description),G()}function G(){d.value=!1,b.value=null,f.value=null,g.value="",h.value=null}return(0,n.sV)((()=>{L=new C.Vv(v.value,{plugins:[_.A,E.Ay],initialView:"dayGridMonth",headerToolbar:!1,dayMaxEvents:3,moreLinkContent:e=>`+${e.num} more`,moreLinkClick:"popover",dateClick:e=>{p.value="upload",k.value=e.dateStr,m.value="",f.value=null,b.value=null,d.value=!0},eventClick:e=>{p.value="view",h.value=e.event,k.value=e.event.startStr,m.value=e.event.title||"",g.value=e.event.extendedProps.description||"",d.value=!0},events:[],eventContent:({event:e})=>{const l=e.title?`<div class="fc-event-title">${e.title}</div>`:"";return{html:`<div class="popover-item">${l}<img src="${e.extendedProps.url}" /></div>`}}}),L.render(),T(),W()})),(0,n.wB)((()=>l.album),(()=>{L.removeAllEvents(),W()})),(e,l)=>((0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("div",K,[(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":l[0]||(l[0]=e=>i.value=e),onChange:T},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,u.R1)(c),(e=>((0,n.uX)(),(0,n.CE)("option",{key:e,value:e},(0,o.v_)(e)+" 年",9,x)))),128))],544),[[a.u1,i.value]]),(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":l[1]||(l[1]=e=>s.value=e),onChange:T},[((0,n.uX)(),(0,n.CE)(n.FK,null,(0,n.pI)(t,((e,l)=>(0,n.Lk)("option",{key:l,value:l},(0,o.v_)(e),9,R))),64))],544),[[a.u1,s.value]])]),(0,n.Lk)("div",{ref_key:"calendarEl",ref:v},null,512),d.value?((0,n.uX)(),(0,n.CE)("div",I,[(0,n.Lk)("div",S,["upload"===p.value?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.Lk)("h2",null,"為 "+(0,o.v_)(k.value)+" 上傳照片",1),(0,n.Lk)("label",X,[l[6]||(l[6]=(0,n.Lk)("span",{class:"block mb-1"},"標題",-1)),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":l[2]||(l[2]=e=>m.value=e),type:"text",placeholder:"輸入標題（可留空）",class:"w-full p-1 border rounded"},null,512),[[a.Jo,m.value]])]),(0,n.Lk)("input",{type:"file",accept:"image/*",onChange:N,class:"mb-4"},null,32),f.value?((0,n.uX)(),(0,n.CE)("div",O,[(0,n.Lk)("img",{src:f.value,alt:"預覽圖"},null,8,V)])):(0,n.Q3)("",!0),(0,n.Lk)("div",{class:"btn-group"},[(0,n.Lk)("button",{onClick:Q},"儲存"),(0,n.Lk)("button",{onClick:G},"取消")])],64)):"view"===p.value?((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[(0,n.Lk)("h2",null,(0,o.v_)(k.value)+" 的照片",1),(0,n.Lk)("div",F,[(0,n.Lk)("img",{src:h.value.extendedProps.url,alt:"照片顯示"},null,8,A)]),h.value.title?((0,n.uX)(),(0,n.CE)("p",U,(0,o.v_)(h.value.title),1)):(0,n.Q3)("",!0),l[7]||(l[7]=(0,n.Lk)("p",{class:"description-label"},"敘述：",-1)),h.value.extendedProps.description?((0,n.uX)(),(0,n.CE)("p",P,(0,o.v_)(h.value.extendedProps.description),1)):((0,n.uX)(),(0,n.CE)("p",J,"（尚無敘述）")),(0,n.Lk)("div",j,[(0,n.Lk)("button",{class:"danger",onClick:q},"刪除照片"),(0,n.Lk)("button",{onClick:l[3]||(l[3]=e=>p.value="edit")},"編輯敘述"),(0,n.Lk)("button",{onClick:G},"關閉")])],64)):((0,n.uX)(),(0,n.CE)(n.FK,{key:2},[(0,n.Lk)("h2",null,"編輯 "+(0,o.v_)(k.value)+" 的照片資訊",1),(0,n.Lk)("label",D,[l[8]||(l[8]=(0,n.Lk)("span",{class:"block mb-1"},"標題",-1)),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":l[4]||(l[4]=e=>m.value=e),type:"text",class:"w-full p-1 border rounded"},null,512),[[a.Jo,m.value]])]),(0,n.Lk)("div",$,[(0,n.Lk)("img",{src:h.value.extendedProps.url,alt:"照片預覽"},null,8,M)]),(0,n.bo)((0,n.Lk)("textarea",{"onUpdate:modelValue":l[5]||(l[5]=e=>g.value=e),rows:"3",class:"textarea mb-4"},null,512),[[a.Jo,g.value]]),(0,n.Lk)("div",{class:"btn-group"},[(0,n.Lk)("button",{class:"primary",onClick:B},"儲存"),(0,n.Lk)("button",{onClick:G},"取消")])],64)),(0,n.Lk)("button",{class:"close-btn",onClick:G},"×")])])):(0,n.Q3)("",!0)]))}};const W=(0,h.A)(T,[["__scopeId","data-v-b27accf8"]]);var N=W;const Q={id:"app"},q={key:1,class:"calendar-container"},B={class:"app-header"},G={class:"album-switch"},Y=["value"],Z=["disabled"],z={key:0,class:"title-display"},H={class:"app-title"},ee={key:1,class:"title-edit"};var le={__name:"App",setup(e){const l=(0,u.KR)(null);function t(){(0,r.CI)(p)}(0,n.sV)((()=>(0,r.hg)(p,(e=>l.value=e))));const i=(0,u.KR)(["相簿日曆"]),s=(0,u.KR)(0),c=(0,u.KR)(""),v=(0,u.KR)(!1);function d(){const e=prompt("請輸入新相簿名稱：")?.trim();e&&!i.value.includes(e)&&(i.value.push(e),s.value=i.value.length-1)}function k(){const e=s.value,l=i.value[e];if(!confirm(`確定要刪除相簿「${l}」嗎？此操作會移除所有圖片資料。`))return;const t=`photoDiary__${l}__`;Object.keys(localStorage).filter((e=>e.startsWith(t))).forEach((e=>localStorage.removeItem(e))),i.value.splice(e,1),e>=i.value.length&&(s.value=i.value.length-1)}function m(){c.value=i.value[s.value],v.value=!0}function b(){const e=c.value.trim();if(e){const l=i.value[s.value],t=e,a=`photoDiary__${l}__`,n=`photoDiary__${t}__`;Object.keys(localStorage).forEach((e=>{if(e.startsWith(a)){const l=localStorage.getItem(e);localStorage.removeItem(e);const t=e.replace(a,n);localStorage.setItem(t,l)}})),i.value[s.value]=t}v.value=!1}function f(){v.value=!1}return(e,u)=>((0,n.uX)(),(0,n.CE)("div",Q,[l.value?((0,n.uX)(),(0,n.CE)("div",q,[(0,n.Lk)("header",B,[(0,n.Lk)("div",G,[(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":u[0]||(u[0]=e=>s.value=e)},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(i.value,((e,l)=>((0,n.uX)(),(0,n.CE)("option",{key:l,value:l},(0,o.v_)(e),9,Y)))),128))],512),[[a.u1,s.value]]),(0,n.Lk)("button",{class:"add-btn",onClick:d,title:"新增相簿"},"＋"),(0,n.Lk)("button",{class:"delete-btn",disabled:1===i.value.length,onClick:k,title:"刪除相簿"},"🗑️",8,Z)]),v.value?((0,n.uX)(),(0,n.CE)("div",ee,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":u[1]||(u[1]=e=>c.value=e),type:"text",class:"title-input",placeholder:"輸入相簿名稱"},null,512),[[a.Jo,c.value]]),(0,n.Lk)("button",{class:"save-btn",onClick:b,title:"儲存變更"},"✔️"),(0,n.Lk)("button",{class:"cancel-btn",onClick:f,title:"取消"},"✖️")])):((0,n.uX)(),(0,n.CE)("div",z,[(0,n.Lk)("h1",H,(0,o.v_)(i.value[s.value]),1),(0,n.Lk)("button",{class:"edit-btn",onClick:m,title:"編輯相簿名稱"},"✏️")])),(0,n.Lk)("button",{onClick:t,class:"logout-btn"},"登出")]),(0,n.bF)(N,{album:i.value[s.value]},null,8,["album"])])):((0,n.uX)(),(0,n.Wv)(y,{key:0}))]))}};const te=(0,h.A)(le,[["__scopeId","data-v-3644e746"]]);var ae=te;(0,a.Ef)(ae).mount("#app")}},l={};function t(a){var n=l[a];if(void 0!==n)return n.exports;var o=l[a]={exports:{}};return e[a].call(o.exports,o,o.exports,t),o.exports}t.m=e,function(){var e=[];t.O=function(l,a,n,o){if(!a){var u=1/0;for(c=0;c<e.length;c++){a=e[c][0],n=e[c][1],o=e[c][2];for(var r=!0,i=0;i<a.length;i++)(!1&o||u>=o)&&Object.keys(t.O).every((function(e){return t.O[e](a[i])}))?a.splice(i--,1):(r=!1,o<u&&(u=o));if(r){e.splice(c--,1);var s=n();void 0!==s&&(l=s)}}return l}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[a,n,o]}}(),function(){t.n=function(e){var l=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(l,{a:l}),l}}(),function(){t.d=function(e,l){for(var a in l)t.o(l,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:l[a]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,l){return Object.prototype.hasOwnProperty.call(e,l)}}(),function(){var e={524:0};t.O.j=function(l){return 0===e[l]};var l=function(l,a){var n,o,u=a[0],r=a[1],i=a[2],s=0;if(u.some((function(l){return 0!==e[l]}))){for(n in r)t.o(r,n)&&(t.m[n]=r[n]);if(i)var c=i(t)}for(l&&l(a);s<u.length;s++)o=u[s],t.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return t.O(c)},a=self["webpackChunkcalendar_upload"]=self["webpackChunkcalendar_upload"]||[];a.forEach(l.bind(null,0)),a.push=l.bind(null,a.push.bind(a))}();var a=t.O(void 0,[504],(function(){return t(410)}));a=t.O(a)})();
//# sourceMappingURL=app.f09d9447.js.map